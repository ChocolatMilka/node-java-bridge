name: System Test
on:
    push:
        tags:
            - '*'
    workflow_dispatch:

jobs:
    test:
        strategy:
            matrix:
                node-version: [16.x, 18.x]
                os: [windows-latest, ubuntu-latest, macOs-latest]
                java-version: [11, 17, 18]
        runs-on: ${{matrix.os}}
        steps:
            - uses: actions/checkout@v3
            - name: Setup Node.js ${{matrix.node-version}} environment
              uses: actions/setup-node@v3.4.1
              with:
                  node-version: ${{matrix.node-version}}
            - name: Setup Java JDK ${{matrix.java-version}}
              uses: actions/setup-java@v3
              with:
                  distribution: 'temurin'
                  java-version: ${{matrix.java-version}}
            - name: Setup tests
              working-directory: ${{github.workspace}}/test/system_test
              run: pwd && ls && npm install
            - name: Run tests
              working-directory: ${{github.workspace}}/test/system_test
              run: npm run test
              timeout-minutes: 2
